# ðŸ¢ ORGANIZATION STRUCTURE - COMPLETE SETUP

## âœ… **SETUP STATUS: COMPLETE**

---

## ðŸ“Š **DATABASE STRUCTURE**

### **Organization Units in Database**
```
Total Units: 17 (Hierarchical Tree Structure)
Total Roles: 15 (Job Titles + GRC Committee Roles)
```

### **ðŸ“‹ Regular Organization Chart (Code: 00001.xxx)**

```
ðŸ“Š CEO Office | Ù…ÙƒØªØ¨ Ø§Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ
â”œâ”€ ðŸ“ Finance Department | Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø§Ù„ÙŠØ©
â”œâ”€ ðŸ“ IT Department | Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
â”‚   â”œâ”€ ðŸ“‚ Cybersecurity Team | ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ù† Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ
â”‚   â”œâ”€ ðŸ“‚ Infrastructure Team | ÙØ±ÙŠÙ‚ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©
â”‚   â””â”€ ðŸ“‚ Application Development | ØªØ·ÙˆÙŠØ± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª
â”œâ”€ ðŸ“ Operations Department | Ù‚Ø³Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
â”œâ”€ ðŸ“ Risk & Compliance Department | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„
â”‚   â”œâ”€ ðŸ“‚ Regulatory Compliance Team | ÙØ±ÙŠÙ‚ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ
â”‚   â”œâ”€ ðŸ“‚ Risk Management Team | ÙØ±ÙŠÙ‚ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø§Ø·Ø±
â”‚   â””â”€ ðŸ“‚ Data Protection Team | ÙØ±ÙŠÙ‚ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”œâ”€ ðŸ“ Internal Audit Department | Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
â””â”€ ðŸ“ Human Resources | Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©
```

### **ðŸŽ¯ GRC Committee Structure (Code: 00002.xxx)**

```
ðŸ“Š GRC Committee | Ù„Ø¬Ù†Ø© Ø§Ù„Ø­ÙˆÙƒÙ…Ø© ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø± ÙˆØ§Ù„Ø§Ù…ØªØ«Ø§Ù„
â”œâ”€ ðŸ“ Compliance Oversight Committee | Ù„Ø¬Ù†Ø© Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„
â”œâ”€ ðŸ“ Risk Oversight Committee | Ù„Ø¬Ù†Ø© Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø±
â””â”€ ðŸ“ Information Security Committee | Ù„Ø¬Ù†Ø© Ø£Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
```

---

## ðŸ‘¥ **ROLES DEFINED (15 Total)**

### **Job Title Roles (Organization Hierarchy)**
1. **CEO** - Chief Executive Officer
2. **CFO** - Chief Financial Officer
3. **CIO** - Chief Information Officer
4. **CISO** - Chief Information Security Officer
5. **Department Manager**
6. **Team Lead**
7. **Senior Officer**
8. **Officer**

### **GRC Committee Roles (Governance)**
9. **GRC Committee Chair** ðŸŽ¯
10. **GRC Committee Member** ðŸŽ¯
11. **Compliance Manager** ðŸŽ¯
12. **Risk Manager** ðŸŽ¯
13. **Control Owner** ðŸŽ¯
14. **Internal Auditor** ðŸŽ¯
15. **External Auditor** ðŸŽ¯

### **System Role**
16. **admin** (pre-existing)

---

## ðŸ§© **DUAL ROLE CAPABILITY**

**Example:**
```
Person: Ahmad Al-Saud
â”œâ”€ Regular Job Title: CIO (Chief Information Officer)
â””â”€ GRC Committee Role: GRC Committee Member
```

This allows someone to have:
- A **job title** in the organizational hierarchy (e.g., "CIO" in IT Department)
- A **GRC role** in the governance committee (e.g., "GRC Committee Member")

---

## ðŸ–¥ï¸ **APPLICATION INTEGRATION**

### **Navigation Menu**
âœ… **Organization Structure** menu item added to **Administration** section
- **English**: "Organization Structure"
- **Arabic**: "Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ…ÙŠ"
- **Icon**: `fas fa-sitemap`
- **Route**: `/Identity/OrganizationUnits`

### **ABP.IO Identity Module**
âœ… The app uses **ABP.IO Framework** which includes:
- `AbpIdentityWebModule` - Built-in Organization Units UI
- Full CRUD operations for Organization Units
- Role assignments to Organization Units
- User assignments to Organization Units
- Hierarchical tree view

### **Location in Menu**
```
Administration (Menu)
â”œâ”€ Admin (Seed Data)
â”œâ”€ API Data Viewer
â”œâ”€ Organization Structure â­ NEW
â”œâ”€ Users (ABP Built-in)
â”œâ”€ Roles (ABP Built-in)
â”œâ”€ Tenants (ABP Built-in)
â””â”€ Settings (ABP Built-in)
```

---

## ðŸ“‹ **DATABASE TABLES USED**

### **Core Tables**
1. **`AbpOrganizationUnits`** - Organization units (departments, teams, committees)
2. **`AbpRoles`** - All roles (job titles + GRC roles)
3. **`AbpUsers`** - User accounts
4. **`AbpUserRoles`** - User-to-Role assignments
5. **`AbpOrganizationUnitRoles`** - Role-to-OrgUnit assignments
6. **`AbpUserOrganizationUnits`** - User-to-OrgUnit assignments

### **Key Columns**
- **`Code`**: Hierarchical code (e.g., `00001.00002.00001`)
- **`ParentId`**: Parent organization unit
- **`DisplayName`**: Bilingual name (e.g., "IT Department | Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª")

---

## ðŸš€ **HOW TO USE**

### **1. Access the Organization Structure**
```
1. Log in to the GRC app
2. Go to: Administration > Organization Structure
3. You'll see the hierarchical tree of all org units
```

### **2. Assign Users to Organization Units**
```
1. Click on an organization unit
2. Click "Members" tab
3. Add users to that unit
```

### **3. Assign Roles to Organization Units**
```
1. Click on an organization unit
2. Click "Roles" tab
3. Assign roles (e.g., "CIO", "GRC Committee Member")
```

### **4. Create RACI Matrix**
Using the dual structure:
- **Regular Org Chart**: Defines reporting lines and department structure
- **GRC Committee**: Defines governance roles and responsibilities

---

## ðŸ“ **SEEDING SCRIPT**

The complete seeding script is available at:
```
/root/app.shahin-ai.com/Shahin-ai/aspnet-core/SEED-ORGANIZATION-STRUCTURE.sql
```

### **Re-run Seeding**
```bash
sudo -u postgres psql -d grc -f /root/app.shahin-ai.com/Shahin-ai/aspnet-core/SEED-ORGANIZATION-STRUCTURE.sql
```

---

## ðŸ” **VERIFICATION QUERIES**

### **Check Organization Units**
```sql
SELECT 
    CASE 
        WHEN LENGTH("Code") - LENGTH(REPLACE("Code", '.', '')) = 0 THEN 'ðŸ“Š Level 1'
        WHEN LENGTH("Code") - LENGTH(REPLACE("Code", '.', '')) = 1 THEN '  ðŸ“ Level 2'
        WHEN LENGTH("Code") - LENGTH(REPLACE("Code", '.', '')) = 2 THEN '    ðŸ“‚ Level 3'
        ELSE '      ðŸ“„ Level 4+'
    END as "Hierarchy",
    "Code",
    "DisplayName"
FROM "AbpOrganizationUnits"
WHERE "IsDeleted" = false
ORDER BY "Code";
```

### **Check Roles**
```sql
SELECT "Name", "NormalizedName", "IsPublic"
FROM "AbpRoles"
ORDER BY "Name";
```

### **Check User Assignments**
```sql
SELECT 
    u."UserName",
    ou."DisplayName" as "OrganizationUnit",
    r."Name" as "Role"
FROM "AbpUsers" u
LEFT JOIN "AbpUserOrganizationUnits" uou ON u."Id" = uou."UserId"
LEFT JOIN "AbpOrganizationUnits" ou ON uou."OrganizationUnitId" = ou."Id"
LEFT JOIN "AbpUserRoles" ur ON u."Id" = ur."UserId"
LEFT JOIN "AbpRoles" r ON ur."RoleId" = r."Id"
WHERE u."IsDeleted" = false;
```

---

## ðŸŽ¯ **NEXT STEPS**

### **1. Seed Sample Users**
Create sample users and assign them to:
- Organization units (departments/teams)
- Job title roles
- GRC committee roles

### **2. Define RACI Matrix**
Map responsibilities:
- **R**esponsible: Who does the work
- **A**ccountable: Who approves the work
- **C**onsulted: Who provides input
- **I**nformed: Who needs to know

### **3. Set Permissions**
Configure ABP permissions based on:
- Organization unit membership
- Role assignments
- GRC committee membership

---

## âœ… **COMPLETION CHECKLIST**

- [x] Database schema created (17 org units)
- [x] Roles defined (15 roles)
- [x] Bilingual names (English + Arabic)
- [x] Navigation menu updated
- [x] Localization files updated (en.json, ar.json)
- [x] ABP Identity module integrated
- [x] Services restarted
- [x] Build successful

---

## ðŸ“š **REFERENCES**

- **ABP.IO Identity Module**: https://docs.abp.io/en/abp/latest/Modules/Identity
- **Organization Units Documentation**: https://docs.abp.io/en/abp/latest/Authorization#organization-units
- **Seeding Script**: `SEED-ORGANIZATION-STRUCTURE.sql`

---

## ðŸŽ‰ **STATUS: READY TO USE**

The organization structure is now fully integrated and accessible in the application!

**Access URL**: https://app-grc.shahin-ai.com (after login)
**Menu Path**: Administration > Organization Structure

